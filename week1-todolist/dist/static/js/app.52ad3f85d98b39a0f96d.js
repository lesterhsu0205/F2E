webpackJsonp([1],{NHnr:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("7+uW"),a=o("mtWM"),i=o.n(a),n=o("Rf8U"),c=o.n(n),d=(o("oPmM"),o("pc4J"),o("g4PW")),r=o.n(d),l=o("Dd8w"),m=o.n(l),u={name:"Item",props:["todo"],data:function(){return{stared:this.$props.todo.stared}},methods:{updateStatus:function(t,e){var o=this,s=m()({},o.todo);s[t]=e,o.$http.put(o.api.getTodoList.concat("/",o.todo.id),s).then(function(s){console.log(s),r()(s.statusText,"OK")&&r()("stared",t)&&(o.stared=e)})},editTodo:function(){this.$emit("edit",this.todo.id)},remove:function(){var t=this;t.$http.delete(t.api.getTodoList.concat("/",t.todo.id)).then(function(e){console.log(e),r()(e.statusText,"OK")&&t.$emit("refresh")})}}},p={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"mb-4"},[o("div",{staticClass:"todo-item",class:{stared:t.stared}},[t._m(0),t._v(" "),o("div",{staticClass:"todo-header"},[o("div",{staticClass:"todo-check"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.todo.completed,expression:"todo.completed"}],attrs:{type:"checkbox",id:"todo-check-".concat(t.todo.id),"true-value":"completed","false-value":"progress"},domProps:{checked:Array.isArray(t.todo.completed)?t._i(t.todo.completed,null)>-1:t._q(t.todo.completed,"completed")},on:{change:[function(e){var o=t.todo.completed,s=e.target,a=s.checked?"completed":"progress";if(Array.isArray(o)){var i=t._i(o,null);s.checked?i<0&&t.$set(t.todo,"completed",o.concat([null])):i>-1&&t.$set(t.todo,"completed",o.slice(0,i).concat(o.slice(i+1)))}else t.$set(t.todo,"completed",a)},function(e){t.updateStatus("completed",t.todo.completed)}]}}),t._v(" "),o("label",{attrs:{for:"todo-check-"+t.todo.id}})]),t._v(" "),o("label",{staticClass:"todo-title",attrs:{for:"todo-check-".concat(t.todo.id)}},[o("span",{class:{completed:Object.is(t.todo.completed,"completed")}},[t._v(t._s(t.todo.message))])]),t._v(" "),o("div",{staticClass:"todo-control"},[o("a",{staticClass:"text-muted",attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.updateStatus("stared",!t.stared)}}},[this.stared?o("i",{staticClass:"fas fa-star mr-3"}):o("i",{staticClass:"far fa-star mr-3"})]),t._v(" "),o("a",{staticClass:"text-muted",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.editTodo(e)}}},[o("i",{staticClass:"fas fa-pencil-alt mr-3"})]),t._v(" "),o("a",{staticClass:"text-muted",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.remove(e)}}},[o("i",{staticClass:"fas fa-trash-alt mr-3"})])])]),t._v(" "),o("div",{staticClass:"todo-footer text-secondary"},[t.todo.startDate||t.todo.endDate?o("i",{staticClass:"far fa-calendar-alt"}):t._e(),t._v(" "),o("span",[t._v("from: "+t._s(t.todo.endDate))]),t._v(" "),t.todo.startDate&&t.todo.endDate?o("span",[t._v(" ~ ")]):t._e(),t._v(" "),o("span",[t._v("to: "+t._s(t.todo.endDate))]),t._v(" "),o("i",{staticClass:"fas fa-comment-dots ml-3"}),t._v(" "+t._s(t.todo.comments.length)+"\n    ")])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"handle text-muted"},[e("i",{staticClass:"fas fa-ellipsis-v"})])}]},f=o("VU/8")(u,p,!1,null,null,null).exports,v={name:"EditForm",props:["todo"],mounted:function(){this.todo.id?this.cacheTodo=m()({},this.todo):this.isNew=!0},watch:{todo:function(){this.cacheTodo=m()({},this.todo)}},data:function(){return{cacheTodo:{},comment:null,isNew:!1}},methods:{updateComment:function(){var t=this;if(t.comment){var e=m()({},t.todo);e.comments.push(t.comment),t.$http.put(t.api.getTodoList.concat("/",t.todo.id),e).then(function(e){console.log(e),t.comment=null})}},update:function(){var t=this,e=m()({},t.cacheTodo);if(t.cacheTodo.message){if(this.isNew){var o=t.api.getTodoList;e.timestamp=Math.floor(Date.now()/1e3),e.stared=!1,e.completed="progress",e.comments=[],t.comment&&e.comments.push(t.comment),t.$http.post(o,e).then(function(e){r()(e.statusText,"Created")&&t.closeEdit()})}else t.comment&&e.comments.push(t.comment),t.$http.put(t.api.getTodoList.concat("/",t.todo.id),e).then(function(t){console.log(t)});t.comment=null}else alert("請輸入訊息")},closeEdit:function(){this.$emit("closeEdit"),this.$emit("refresh")}}},h={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"mb-4"},[o("div",{staticClass:"todo-item active"},[o("div",{staticClass:"todo-header"},[o("div",{staticClass:"todo-check"}),t._v(" "),o("div",{staticClass:"todo-title"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.cacheTodo.message,expression:"cacheTodo.message"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.cacheTodo.message},on:{input:function(e){e.target.composing||t.$set(t.cacheTodo,"message",e.target.value)}}})])]),t._v(" "),o("div",{staticClass:"todo-body"},[o("div",{staticClass:"todo-content"},[o("div",{staticClass:"todo-row"},[t._m(0),t._v(" "),o("div",[o("label",{attrs:{for:""}},[t._v("Deadline")]),t._v(" "),o("div",{staticClass:"form-inline todo-form-control"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.cacheTodo.startDate,expression:"cacheTodo.startDate"}],staticClass:"form-control border-0",attrs:{type:"date"},domProps:{value:t.cacheTodo.startDate},on:{input:function(e){e.target.composing||t.$set(t.cacheTodo,"startDate",e.target.value)}}}),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.cacheTodo.endDate,expression:"cacheTodo.endDate"}],staticClass:"form-control border-0 ml-2",attrs:{type:"date"},domProps:{value:t.cacheTodo.endDate},on:{input:function(e){e.target.composing||t.$set(t.cacheTodo,"endDate",e.target.value)}}})])])]),t._v(" "),t.todo?o("div",{staticClass:"todo-row"},[t._m(1),t._v(" "),o("div",{staticClass:"todo-form-control"},[o("label",{attrs:{for:""}},[t._v("Comment")]),t._v(" "),t._l(t.cacheTodo.comments,function(e,s){return o("div",{key:s,staticClass:"bg-white p-3 my-3"},[t._v(t._s(e))])}),t._v(" "),o("div",[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"form-control w-100 border-0",attrs:{name:""},domProps:{value:t.comment},on:{keydown:function(e){return("button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter"))&&e.shiftKey?t.updateComment(e):null},input:function(e){e.target.composing||(t.comment=e.target.value)}}})])],2)]):t._e()]),t._v(" "),o("div",{staticClass:"todo-btn-group d-flex"},[o("button",{staticClass:"btn text-danger w-50 btn-lg",on:{click:t.closeEdit}},[o("i",{staticClass:"fas fa-times"}),t._v(" Cancel\n        ")]),t._v(" "),o("button",{staticClass:"btn btn-primary w-50 btn-lg",on:{click:t.update}},[o("i",{staticClass:"fas fa-plus"}),t._v(" Update Task\n        ")])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"todo-icon"},[e("i",{staticClass:"far fa-calendar-alt"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"todo-icon"},[e("i",{staticClass:"far fa-comment-dots"})])}]},_=o("VU/8")(v,h,!1,null,null,null).exports,g=o("DAYN"),C={name:"App",components:{Item:f,EditForm:_,draggable:o.n(g).a},mounted:function(){this.getData()},data:function(){return{message:"",todoItem:[],currentEdit:{},isNewTodo:!1,currentTab:"myTask",localData:{todoItems:[{message:"第一筆資料",startDate:"2018-06-01",endDate:"2018-06-06",timestamp:1528270961,stared:!1,completed:"completed",comments:[],id:1,order:2},{message:"第二筆資料",startDate:"2018-06-01",endDate:"2018-06-06",timestamp:1528271043,stared:!1,completed:"completed",comments:[],id:2,order:1},{message:"第三筆資料",startDate:"2018-06-01",endDate:"2018-06-06",timestamp:1528277505,stared:!1,completed:"completed",comments:[],id:3,order:0}]}}},methods:{add:function(){this.isNewTodo=!0,this.currentEdit={}},getData:function(){var t=this;t.todoItem=[],t.$http.get(t.api.getTodoList).then(function(e){e.data.forEach(function(e){t.todoItem.push(e)}),t.todoItem.sort(function(t,e){return t.order>e.order?1:-1})})},edit:function(t){this.isNewTodo=!1,this.currentEdit=this.todoItem.find(function(e){return e.id===t})},closeEdit:function(){this.isNewTodo=!1,this.currentEdit={}},sort:function(){var t=this;t.todoItem.map(function(t,e){return{id:t.id,order:e}}).forEach(function(e){t.$http.patch(t.api.getTodoList.concat("/",e.id),{order:e.order})})}}},T={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("div",{staticClass:"bg-primary"},[o("div",{staticClass:"container justify-content-between d-flex todo-nav"},[o("a",{class:{active:"myTask"===t.currentTab},attrs:{href:"#"},on:{click:function(e){t.currentTab="myTask"}}},[t._v("My Task")]),t._v(" "),o("a",{class:{active:"progress"===t.currentTab},attrs:{href:"#"},on:{click:function(e){t.currentTab="progress"}}},[t._v("In Progress")]),t._v(" "),o("a",{class:{active:"completed"===t.currentTab},attrs:{href:"#"},on:{click:function(e){t.currentTab="completed"}}},[t._v("Completed")])])]),t._v(" "),o("div",{staticClass:"container my-4"},[o("div",{staticClass:"position-relative"},[o("i",{staticClass:"fas fa-plus fa-lg text-black-50 position-absolute",staticStyle:{left:"1rem",top:"1.15rem"}}),t._v(" "),t.isNewTodo?t._e():o("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],staticClass:"form-control form-control-lg pl-5",attrs:{type:"text"},domProps:{value:t.message},on:{focus:t.add,input:function(e){e.target.composing||(t.message=e.target.value)}}})]),t._v(" "),o("div",{staticClass:"mt-4"},[o("transition",{attrs:{name:"slide"}},[t.isNewTodo&&!t.currentEdit.id?o("edit-form",{attrs:{todo:t.currentEdit},on:{refresh:t.getData,closeEdit:t.closeEdit}}):t._e()],1),t._v(" "),o("draggable",{attrs:{options:{handle:".handle"}},on:{end:t.sort},model:{value:t.todoItem,callback:function(e){t.todoItem=e},expression:"todoItem"}},t._l(t.todoItem,function(e){return"myTask"===t.currentTab||t.currentTab==e.completed?o("div",{key:e.id},[Object.is(t.currentEdit.id,e.id)?t._e():o("item",{attrs:{todo:e},on:{refresh:t.getData,edit:t.edit}}),t._v(" "),Object.is(t.currentEdit.id,e.id)?o("edit-form",{attrs:{todo:t.currentEdit},on:{refresh:t.getData,closeEdit:t.closeEdit}}):t._e()],1):t._e()}))],1)])])},staticRenderFns:[]};var b=o("VU/8")(C,T,!1,function(t){o("qsqF")},null,null).exports;s.a.use(c.a,i.a),s.a.config.productionTip=!1,s.a.prototype.api={getTodoList:"http://localhost:3000/todoItems"},new s.a({el:"#app",components:{App:b},template:"<App/>"})},oPmM:function(t,e){},pc4J:function(t,e){},qsqF:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.52ad3f85d98b39a0f96d.js.map